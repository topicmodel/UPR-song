<div class th:fragment="html">
    <script>
        $(function(){
            var company =  getUrlParms("company");
            var keyword = getUrlParms("keyword");
            console.log(company+","+keyword);
            //图表

            var data4Vue = {
                uri:'analyseCompanyInventor',
                keywords:[],
                inventors:[],
                patents:[],
                similarPatents:[],
                name:{name:''},
                personnames:[],
                link:{target:'',source:'',name:''},
                personlinks:[],
                university:company,
                showNetwork:true,
                showPatentList:false,
                showSimilarPatent:false
        };

            //ViewModel
            var vue = new Vue({
                el: '#workingArea',
                data: data4Vue,
                mounted:function(){ //mounted　表示这个 Vue 对象加载成功了
                    this.load();
                },
                methods: {
                    load:function(){

                        var url =  this.uri+"?company="+company+"&keyword="+keyword;
                        console.log(url);
                        //获取数据
                        axios.post(url).then(function(response) {

                          var result = response.data;
                            vue.links=result.link;
                            vue.inventors = result.inventor;
                            vue.patents = result.patents;
                            vue.similarPatents = result.similar;

                            for(var j=0;j<vue.links.length;j++){
                                vue.link.target = vue.links[j].target;
                                vue.link.source = vue.links[j].source;
                                vue.link.name = vue.links[j].name;
                                vue.personlinks.push(vue.link);
                                vue.link={target:'',source:'',name:''};
                            }

                            for (var i=0;i<vue.inventors.length;i++){
                                console.log(vue.inventors[i].inventorName);
                                vue.name.name=vue.inventors[i].inventorName;
                                vue.personnames.push(vue.name);
                                vue.name={name:''};
                            }
                            console.log(vue.name[0]);
                            var myChart = echarts.init(document.getElementById('main'));
                            //数据加载完之前先显示一段简单的loading动画
                            //myChart.showLoading();
                            //网络图显示
                            option = {
                                title: {
                                    show:true,
                                    /*text: '高校前沿研究团队',*/
                                    backgroundColor: 'SeaGreen',
                                    textStyle: {
                                        color:"white",
                                        fontWeight: "bolder",
                                        fontSize:"15"
                                    },

                                },
                                tooltip: {
                                    formatter: function (x) {
                                        return x.data.des;
                                    }
                                },
                                series: [
                                    {
                                        type: 'graph',
                                        layout: 'force',
                                        symbolSize: 80,
                                        roam: true,
                                        edgeSymbol: ['circle', 'arrow'],
                                        edgeSymbolSize: [4, 10],
                                        edgeLabel: {
                                            normal: {
                                                textStyle: {
                                                    fontSize: 20

                                                }
                                            }
                                        },
                                        force: {
                                            repulsion: 2500,
                                            edgeLength: [10, 50]
                                        },
                                        draggable: true,
                                        itemStyle: {
                                            normal: {
                                                color: '#3d5b0d'
                                            }
                                        },
                                        lineStyle: {
                                            normal: {
                                                width: 2,
                                                color: '#0c5b56'
                                            }
                                        },
                                        edgeLabel: {
                                            normal: {
                                                show: true,
                                                formatter: function (x) {
                                                    return x.data.name;
                                                }
                                            }
                                        },
                                        label: {
                                            normal: {
                                                show: true,
                                                textStyle: {
                                                }
                                            }
                                        },
                                        data: vue.personnames,
                                        links: vue.personlinks,
                                    }
                                ]
                            };
                            myChart.setOption(option);
                            vue.$nextTick(function(){
                                linkDefaultActions();
                            })
                        });

                    },
                    /*两张图进行切换*/
                    toggle2Detail:function(){
                        vue.showNetwork=true;
                        vue.showPatentList=false;
                        vue.showSimilarPatent = false;
                    },
                    toggle2Review:function(){
                        vue.showNetwork=false;
                        vue.showPatentList=true;
                        vue.showSimilarPatent = false;
                    },
                    toggle2Similar:function(){
                        vue.showNetwork=false;
                        vue.showPatentList=false;
                        vue.showSimilarPatent = true;
                    }
                }
            });
        })
    </script>

    <div id="topicSearchResult">
        <div class="topicSearchResultDiv">
            <div th:replace="include/fore/companyInventorShow::html" ></div>
        </div>
    </div>
</div>
